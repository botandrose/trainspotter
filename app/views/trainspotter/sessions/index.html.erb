<div class="trainspotter">
  <header class="trainspotter-header">
    <h1>Trainspotter - Sessions</h1>
    <div class="trainspotter-controls">
      <%= form_with url: sessions_path, method: :get, data: { turbo_action: "replace" } do %>
        <% if @available_log_files.size > 1 %>
          <%= select_tag :log_file,
              options_for_select(@available_log_files, @current_log_file),
              class: "log-file-selector",
              onchange: "this.form.requestSubmit()" %>
        <% else %>
          <span class="current-log-file"><%= @current_log_file %></span>
        <% end %>
        <label class="show-anonymous-toggle">
          <%= check_box_tag :show_anonymous, "1", @show_anonymous,
              onchange: "this.form.requestSubmit()" %>
          Show anonymous
        </label>
      <% end %>
      <%= link_to "Requests", requests_path, class: "nav-link" %>
    </div>
  </header>

  <main class="trainspotter-main">
    <div class="session-list">
      <% @sessions.each do |session| %>
        <%= render "trainspotter/sessions/session", session: session %>
      <% end %>
    </div>

    <% if @sessions.empty? %>
      <div class="empty-state">
        <p>No sessions found in the log file.</p>
        <% if !@show_anonymous %>
          <p class="hint">Try checking "Show anonymous" to see sessions without identified users.</p>
        <% else %>
          <p class="hint">Make some requests to your Rails app to see sessions here.</p>
        <% end %>
      </div>
    <% end %>
  </main>
</div>
