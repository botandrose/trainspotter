<div class="trainspotter"
     data-controller="sessions"
     data-sessions-sessions-url-value="<%= sessions_path %>">
  <header class="trainspotter-header">
    <h1>Trainspotter - Sessions</h1>
    <div class="trainspotter-controls">
      <% if @available_log_files.size > 1 %>
        <select name="log_file" class="log-file-selector" data-sessions-target="logFile" data-action="change->sessions#changeLogFile">
          <% @available_log_files.each do |log_file| %>
            <option value="<%= log_file %>" <%= "selected" if log_file == @current_log_file %>><%= log_file %></option>
          <% end %>
        </select>
      <% else %>
        <span class="current-log-file"><%= @current_log_file %></span>
      <% end %>
      <label class="show-anonymous-toggle">
        <input type="checkbox" <%= "checked" if @show_anonymous %> data-sessions-target="showAnonymous" data-action="change->sessions#changeShowAnonymous">
        Show anonymous
      </label>
      <%= link_to "Requests", requests_path, class: "nav-link" %>
    </div>
  </header>

  <main class="trainspotter-main">
    <div class="session-list">
      <% @sessions.each do |session| %>
        <%= render "trainspotter/sessions/session", session: session %>
      <% end %>
    </div>

    <% if @sessions.empty? %>
      <div class="empty-state">
        <p>No sessions found in the log file.</p>
        <% if !@show_anonymous %>
          <p class="hint">Try checking "Show anonymous" to see sessions without identified users.</p>
        <% else %>
          <p class="hint">Make some requests to your Rails app to see sessions here.</p>
        <% end %>
      </div>
    <% end %>
  </main>
</div>
